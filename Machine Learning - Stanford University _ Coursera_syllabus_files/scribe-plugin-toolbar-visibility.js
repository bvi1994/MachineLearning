define("bundles/scribe-plugins/scribe-plugin-toolbar-visibility",["require","exports","module","jquery","underscore"],function(require,exports,module){"use strict";var $=require("jquery"),_=require("underscore");module.exports=function(n,e,t){return function(r){function hideToolbar(){$(e).hide()}function showToolbar(){$(e).show()}function doesNotBelongToScribe(e){return e===document?!0:document.activeElement===r.el?!1:e&&e!==n?doesNotBelongToScribe(e.parentNode):!1}function handleBlur(e){doesNotBelongToScribe(e.relatedTarget)&&hideToolbar()}function handleDocumentClick(e){doesNotBelongToScribe(e.target)&&hideToolbar()}var u=e.querySelectorAll("[data-command-name]");_(u).each(function(e){e.addEventListener("blur",handleBlur)}),r.el.addEventListener("focus",showToolbar),document.addEventListener("click",handleDocumentClick),e.addEventListener("mousedown",function(e){if("BUTTON"!==e.target.nodeName)return e.preventDefault(),!1}),t||hideToolbar()}}});