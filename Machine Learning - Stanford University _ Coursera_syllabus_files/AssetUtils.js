define("bundles/scribe-plugins/scribe-plugin-asset-command/AssetUtils",["require","exports","module","q","jquery","underscore","react","react-dom/server","bundles/scribe-plugins/scribe-utils"],function(require,exports,module){"use strict";function _defaults(e,i){for(var a=Object.getOwnPropertyNames(i),t=0;t<a.length;t++){var n=a[t],r=Object.getOwnPropertyDescriptor(i,n);r&&r.configurable&&void 0===e[n]&&Object.defineProperty(e,n,r)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var t,n,a=require("q"),$=require("jquery"),_=require("underscore"),e=require("react"),r=require("react-dom/server"),i=require("bundles/scribe-plugins/scribe-utils"),s=i.isEmptyParagraphBlock,o=function(t){function RemoveAssetButton(){return _classCallCheck(this,RemoveAssetButton),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(RemoveAssetButton,t),RemoveAssetButton.prototype.render=function render(){return e.createElement("a",{title:"Delete",className:"cml-remove-asset-button"},"Ã—")},RemoveAssetButton}(e.Component),u=(n=t=function(t){function AssetNode(){var r,n,i;_classCallCheck(this,AssetNode);for(var a=arguments.length,s=Array(a),e=0;a>e;e++)s[e]=arguments[e];return r=n=_possibleConstructorReturn(this,t.call.apply(t,[this].concat(s))),n.getNameAndExtension=function(e){var t=e.lastIndexOf("."),n="",r=e;return t>-1&&(r=e.substring(0,t),n=e.substring(t+1)),{name:r,extension:n}},i=r,_possibleConstructorReturn(n,i)}return _inherits(AssetNode,t),AssetNode.prototype.render=function render(){var t=this.props,i=t.id,a=t.url,n=t.filename,s=t.typeName,r=this.getNameAndExtension(n),o=r.name,u=r.extension;return e.createElement("div",{className:"cml-asset","data-id":i,"data-name":o,"data-type":s,"data-extension":u},e.createElement("a",{className:"cml-asset-link",href:a},n))},AssetNode}(e.Component),t.propTypes={id:e.PropTypes.string.isRequired,url:e.PropTypes.string.isRequired,filename:e.PropTypes.string.isRequired,typeName:e.PropTypes.string.isRequired},n),c=function initializeAssetBlocks(n){var t=$(n).find(".cml-asset:not([data-initialized=true])");t.attr("data-initialized",!0),t.append($(r.renderToStaticMarkup(e.createElement(o,null))).get(0))},l=function injectAsset(a,t,n,o){var c=n.id,l=n.typeName,p=n.filename,i=$(r.renderToStaticMarkup(e.createElement(u,{id:c,url:o,filename:p,typeName:l}))).get(0);s(a,t)?(t.nextSibling||t.parentNode.appendChild(document.createElement("p")),t.parentNode.replaceChild(i,t)):t.nextSibling?t.parentNode.insertBefore(i,t.nextSibling):(t.parentNode.appendChild(i),t.parentNode.appendChild(document.createElement("p")))},p=function insertAsset(t,n,r,e){var i=_(e).pluck("id");a(r.getAssetMap(i)).then(function(r){return _(e).map(function(e){return l(t,n,e,r[e.id].url.url)})})},d=function isAssetBlock(e){return e&&$(e).hasClass("cml-asset")},m=function isRemoveButton(e){return e&&$(e).hasClass("cml-remove-asset-button")};module.exports={initializeAssetBlocks:c,insertAsset:p,isAssetBlock:d,isRemoveButton:m}});