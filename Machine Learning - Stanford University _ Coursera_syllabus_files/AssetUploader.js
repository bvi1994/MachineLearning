define("bundles/asset-admin/components/AssetUploader",["require","exports","module","underscore","classnames","react","react-dom","bundles/asset-admin/components/AssetsList","bundles/asset-admin/actions/AssetAdminActions","i18n!nls/asset-admin","js/lib/coursera.react-intl","bundles/asset-admin/constants/UploadStatus","css!./__styles__/AssetUploader"],function(require,exports,module){"use strict";function _defaults(e,a){for(var o=Object.getOwnPropertyNames(a),t=0;t<o.length;t++){var s=o[t],r=Object.getOwnPropertyDescriptor(a,s);r&&r.configurable&&void 0===e[s]&&Object.defineProperty(e,s,r)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}function _defineProperty(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var s,c,i,n,p,_=require("underscore"),E=require("classnames"),e=require("react"),y=require("react-dom"),h=require("bundles/asset-admin/components/AssetsList"),m=require("bundles/asset-admin/actions/AssetAdminActions"),v=m.openFileBrowser,A=m.initializeUploader,t=require("i18n!nls/asset-admin"),f=require("js/lib/coursera.react-intl"),l=f.FormattedMessage,r=require("bundles/asset-admin/constants/UploadStatus"),b=r.IDLE,u=r.IN_PROGRESS,o=r.FAILED,d=r.SUCCESS,g=(s={},_defineProperty(s,u,t("Uploading")),_defineProperty(s,o,t("Failed")),_defineProperty(s,d,t("Uploded")),s);require("css!./__styles__/AssetUploader");var a=(i=c=function(t){function UploadList(){return _classCallCheck(this,UploadList),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(UploadList,t),UploadList.prototype.render=function render(){var t=this.props,s=t.status,r=t.files,a=g[s]||"";return e.createElement("ul",{className:"asset-files-list"},_(r).map(function(t){return e.createElement("li",{key:t.name},e.createElement("span",{className:"asset-file-name"},t.name),e.createElement("span",{className:"asset-file-status"},a))}))},UploadList}(e.Component),c.propTypes={files:e.PropTypes.array,status:e.PropTypes.string},i),T=(p=n=function(s){function AssetUploader(){var r,e,a;_classCallCheck(this,AssetUploader);for(var o=arguments.length,n=Array(o),t=0;o>t;t++)n[t]=arguments[t];return r=e=_possibleConstructorReturn(this,s.call.apply(s,[this].concat(n))),e.state={isDropZoneActive:!1},e.handleDragEnter=function(t){t.preventDefault(),e.setState({isDropZoneActive:!0})},e.resetDropZone=function(){e.setState({isDropZoneActive:!1})},e.openFileBrowser=function(){e.context.executeAction(v)},a=r,_possibleConstructorReturn(e,a)}return _inherits(AssetUploader,s),AssetUploader.prototype.componentDidMount=function componentDidMount(){var e=this.props,t=e.assetType,s=e.pdfTemplate,r=e.course,a=r.id,o=y.findDOMNode(this.refs.bulkUploadContainer);this.context.executeAction(A,{courseId:a,assetType:t,pdfTemplate:s,container:o})},AssetUploader.prototype.renderUploadFailure=function renderUploadFailure(){var t=this.props,r=t.uploadStatus,s=t.uploadAttempts;if(r.state===o)return e.createElement("div",{className:"upload-status-wrapper"},e.createElement(a,{files:s.success,status:d}),e.createElement(a,{files:s.error,status:o}))},AssetUploader.prototype.renderUploadedAssets=function renderUploadedAssets(){var t=this.props,s=t.uploadedAssets,r=t.selectedAssets,a=t.allowMultiple;if(!_(s).isEmpty())return e.createElement(h,{assets:s,allowMultiple:a,selectedAssets:r})},AssetUploader.prototype.renderUploader=function renderUploader(){var s=E("uploader-drop-zone-wrapper",{active:this.state.isDropZoneActive,hidden:this.props.uploadStatus.state!==b});return e.createElement("div",{ref:"fileDropZone",className:s,onDrop:this.resetDropZone,onDragLeave:this.resetDropZone,onDragEnter:this.handleDragEnter},e.createElement("div",{className:"uploader-drop-zone"},e.createElement("div",{ref:"bulkUploadContainer"}),e.createElement("button",{className:"uploader-action",onClick:this.openFileBrowser},t("Add Files")),e.createElement("p",{className:"upload-guideline"},t("or drop files here")),e.createElement("p",{className:"upload-note"},e.createElement(l,{message:t("The files you upload will be added to {courseName} course assets."),courseName:this.props.course.name}))))},AssetUploader.prototype.renderUploadProgress=function renderUploadProgress(){var t=this.props.uploadStatus;if(t.state===u){var s=t.progress,r=t.files,o=t.state;return e.createElement("div",{className:"upload-status-wrapper"},e.createElement("div",{className:"upload-status-bar"},e.createElement("span",{className:"progress-bar",style:{width:s+"%"}})),e.createElement(a,{files:r,status:o}))}},AssetUploader.prototype.render=function render(){return e.createElement("div",{className:"rc-AssetUploader"},e.createElement("h2",{className:"folder-name"},e.createElement(l,{message:t("Upload to {courseName}"),courseName:this.props.course.name})),e.createElement("div",{className:"uploader-wrapper"},this.renderUploadProgress(),this.renderUploadFailure(),this.renderUploadedAssets(),this.renderUploader()))},AssetUploader}(e.Component),n.propTypes={course:e.PropTypes.object.isRequired,assetType:e.PropTypes.string,pdfTemplate:e.PropTypes.string,allowMultiple:e.PropTypes.bool,uploadStatus:e.PropTypes.object.isRequired,uploadAttempts:e.PropTypes.object,selectedAssets:e.PropTypes.array,uploadedAssets:e.PropTypes.array},n.contextTypes={executeAction:e.PropTypes.func.isRequired},p);module.exports=T});