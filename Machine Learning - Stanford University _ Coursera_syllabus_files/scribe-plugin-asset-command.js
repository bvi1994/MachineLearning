define("bundles/scribe-plugins/scribe-plugin-asset-command",["require","exports","module","react","react-dom","js/lib/AssetManager","bundles/asset-admin/components/AssetAdminModal","bundles/scribe-plugins/scribe-utils","bundles/scribe-plugins/scribe-plugin-asset-command/AssetUtils"],function(require,exports,module){"use strict";var c=require("react"),t=require("react-dom"),r=require("js/lib/AssetManager"),a=require("bundles/asset-admin/components/AssetAdminModal"),n=require("bundles/scribe-plugins/scribe-utils"),o=n.findBlockContainer,i=n.findSelectedElement,u=n.isEmptyParagraphBlock,e=require("bundles/scribe-plugins/scribe-plugin-asset-command/AssetUtils"),l=e.insertAsset,s=e.isAssetBlock,d=e.isRemoveButton,m=e.initializeAssetBlocks;module.exports=function(e){return function(n){var p=new n.api.Command("asset"),g=new r,b=null,f=null,M=function handleAssetModalSelect(e){n.transactionManager.run(function(){return l(n,f,g,e)}),t.unmountComponentAtNode(b)},A=function handleAssetModalCancel(){t.unmountComponentAtNode(b)},C=function handleBackspace(e){n.transactionManager.run(function(){var t=i(n),o=t.previousSibling,r=t.nextSibling;u(n,t)&&(!o&&s(r)?(e.preventDefault(),n.el.removeChild(t)):s(o)&&(e.preventDefault(),s(r)?n.el.removeChild(t):n.el.removeChild(o)))})},h=function handleKeydown(e){8===e.keyCode&&C(e)},E=function handleMousedown(e){n.transactionManager.run(function(){var t=e.target;d(t)&&(e.preventDefault(),n.el.removeChild(o(n,t)))})},v=function handleContentChange(){return m(n.el)};p.execute=function(){f=i(n),b=document.createElement("div"),document.body.appendChild(b),t.render(c.createElement(a,{courseId:e.context.courseId,onSelect:M,onCancel:A}),b)},p.queryEnabled=function(){return!0},n.on("content-changed",v),n.el.addEventListener("keydown",h),n.el.addEventListener("mousedown",E),n.commands.asset=p}}});